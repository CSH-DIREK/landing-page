<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="title" content="CshDirek S.A" />
    <meta
      name="description"
      content="CSH DIREK A financial solution in every Haitian's pocket."
    />
    <meta name="keywords" content="wallet,wallet cms,CshDirek" />

    <link
      rel="apple-touch-icon"
      href="./assets/images/8838201231644403288.png"
    />

    <meta itemprop="name" content="Home" />
    <meta
      itemprop="description"
      content="CSH DIREK A financial solution in every Haitian's pocket."
    />
    <meta itemprop="image" content="./assets/images/8838201231644403288.png" />

    <meta property="og:type" content="website" />
    <meta property="og:title" content="CSH DIREK" />
    <meta
      property="og:description"
      content="CSH DIREK A financial solution in every Haitian's pocket."
    />
    <meta
      property="og:image"
      content="./assets/images/8838201231644403288.png"
    />
    <meta property="og:image:type" content="image/png" />

    <meta property="og:url" content="https://cshdirek.com" />

    <meta name="twitter:card" content="summary_large_image" />
    <title>CshDirek S.A - Register</title>

    <link rel="stylesheet" href="./assets/frontend/css/bootstrap.min.css" />
    <link rel="stylesheet" href="./assets/frontend/css/animate.css" />
    <link rel="stylesheet" href="./assets/frontend/css/all.min.css" />
    <link rel="stylesheet" href="./assets/frontend/css/lightbox.min.css" />
    <link rel="stylesheet" href="./assets/frontend/css/odometer.css" />
    <link rel="stylesheet" href="./assets/frontend/css/owl.min.css" />
    <link rel="stylesheet" href="./assets/frontend/css/default.min.css" />
    <link href="./assets/frontend/css/main.css" rel="stylesheet" />

    <link rel="shortcut icon" href="./assets/images/favicon.ico" />
  </head>

  <body>
    <div class="overlayer"></div>

    <!-- Header -->
    <div class="navbar-top bg--base">
      <div class="container">
        <div
          class="d-flex flex-wrap justify-content-evenly justify-content-md-between"
        >
          <ul class="social-icons py-1 py-md-0">
            <li>
              <a
                target="_blank"
                href="https://www.facebook.com/profile.php?id=61569848916196&mibextid=ZbWKwL"
                ><i class="fab fa-facebook-f"></i
              ></a>
            </li>
            <li>
              <a target="_blank" href="https://x.com/cshdirek?s=11"
                ><i class="fab fa-twitter"></i
              ></a>
            </li>
            <li>
              <a
                target="_blank"
                href="https://www.instagram.com/cshdirek/profilecard/?igsh=MW1iZzVocmc4eW0zeQ=="
                ><i class="fab fa-instagram"></i
              ></a>
            </li>
            <li>
              <a
                target="_blank"
                href="https://www.linkedin.com/in/csh-direk-sa-6b6125342"
                ><i class="fab fa-linkedin-in"></i
              ></a>
            </li>
            <li>
              <a target="_blank" href="https://www.youtube.com/@CSHDIREKSA"
                ><i class="fab fa-youtube"></i
              ></a>
            </li>
          </ul>
          <ul class="contact-bar py-1 py-md-0">
            <li>
              <a href="Tel:+1 (645) 221-9141">+1 (645) 221-9141</a>
            </li>
            <li>
              <a href="Mailto:support@cshdirek.com">support@cshdirek.com</a>
            </li>
            <li>
              <div class="change-language d-none d-sm-block">
                <select class="language-bar" id="languageSelectorDesktop">
                  <option value="en" selected>English</option>
                  <option value="fr">Français</option>
                  <option value="ht">Kreyòl Ayisyen</option>
                </select>
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="navbar-bottom">
      <div class="container">
        <div class="navbar-wrapper">
          <div class="logo">
            <a href="/">
              <img src="./assets/images/logo.png" alt="logo" />
            </a>
          </div>
          <div class="change-language d-sm-none ms-auto me-3 text--title">
            <select class="language-bar" id="languageSelectorMobile">
              <option value="en" selected>English</option>
              <option value="fr">Français</option>
              <option value="ht">Kreyòl Ayisyen</option>
            </select>
          </div>
          <div class="nav-toggle d-lg-none">
            <span></span>
            <span></span>
            <span></span>
          </div>
          <div class="nav-menu-area">
            <div class="menu-close text--danger d-lg-none">
              <i class="fas fa-times"></i>
            </div>
            <ul class="nav-menu">
              <li>
                <a target="" href="/" data-translate="home">Home</a>
              </li>
              <li>
                <a target="" href="/about.html" data-translate="about">About</a>
              </li>
              <li>
                <a target="" href="/#services" data-translate="services"
                  >Services</a
                >
              </li>
              <!-- <li>
              <a target="" href="/contact.html" data-translate="join_us">Join Us</a>
            </li> -->
              <li>
                <a target="" href="/contact.html" data-translate="contact"
                  >Contact</a
                >
              </li>

              <li>
                <div class="btn__grp ms-lg-3">
                  <a
                    href="https://api.cshdirek.com/admin/cshdirek/login/"
                    class="cmn--btn"
                    data-translate="login"
                    >Login</a
                  >
                  <a
                    href="./register.html"
                    class="cmn--btn btn-outline"
                    data-translate="register"
                    >Register</a
                  >
                </div>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
    <!-- Header -->
    <section class="ctas-section pt-10 pb-50 position-relative overflow-hidden">
      <div class="container">
        <section class="register_con pt-10 pb-50">
          <h3 data-translate="register_h3">
            Envoyez, recevez, payez en toute simplicité – Créez votre compte CSH
            Direk
          </h3>
          <form class="contact-form row g-4">
            <div class="form first">
              <div class="details personal">
                <div class="fields">
                  <div class="input-field">
                    <label data-translate="register_label">Type compte</label>
                    <select name="user_type" id="user_type" required>
                      <option
                        disabled
                        selected
                        data-translate="register_option"
                      >
                        Choisir le type compte
                      </option>
                      <option value="supervisor">Master Agent</option>
                      <option value="vendor" selected>Agent</option>
                    </select>
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="register_label1"
                      >Nom de l'Entreprise</label
                    >
                    <input
                      name="entreprise_nom"
                      placeholder="Nom de l'Entreprise"
                      data-translate="register_placeholder"
                      type="text"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="register_label2"
                      >Prénom du proprietaire</label
                    >
                    <input
                      name="first_name"
                      type="text"
                      placeholder="Prénom du propriétaire"
                      data-translate="register_palceholder2"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>

                  <div class="input-field">
                    <label data-translate="register_label3"
                      >Nom du proprietaire</label
                    >
                    <input
                      name="last_name"
                      type="text"
                      placeholder="Nom du propriétaire"
                      data-translate="register_placeholder3"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>

                  <div class="input-field">
                    <label data-translate="register_label4">Pays</label>
                    <select name="country" id="country" required></select>
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="register_label5">Département</label>
                    <select
                      name="departement"
                      id="departement"
                      required
                    ></select>
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="register_label6">Longitude</label>
                    <input
                      name="longitude"
                      placeholder="Longitude"
                      data-translate="register_longitude"
                      type="number"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="register_label7">Latitude</label>
                    <input
                      name="latitude"
                      placeholder="Latitude"
                      data-translate="register_latitude"
                      type="number"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="register_label8">Ville</label>
                    <select name="city" id="city" required></select>
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="register_label9"
                      >Adresse de l'Entreprise</label
                    >
                    <input
                      name="entreprise_adresse"
                      placeholder="Adresse de l'Entreprise"
                      data-translate="register_label9"
                      type="text"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="register_label_adresse"
                      >Adresse du proprietaire</label
                    >
                    <input
                      name="proprietaire_adresse"
                      placeholder="Adresse du proprietaire"
                      data-translate="placeholder_adresse"
                      type="text"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="register_label_type"
                      >Type d'Entreprise</label
                    >
                    <select
                      name="type_entreprise"
                      id="type_entreprise"
                      required
                    ></select>
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="categorie">Catégories</label>
                    <select name="categorie" id="categorie" required></select>
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="electronique"
                      >Adresse Electronique</label
                    >
                    <input
                      name="proprietaire_email"
                      type="email"
                      placeholder="Adresse Electronique de l'entreprise"
                      data-translate="placeholder_electroique"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="telephone_register"
                      >Téléphone du Proprietaire</label
                    >
                    <input
                      name="proprietaire_telephone"
                      placeholder="Téléphone du Proprietaire"
                      data-translate="placeholder_telephone"
                      type="tel"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label data-translate="genre_p">Genre du Proprietaire</label>
                    <select name="genre" id="genre" required></select>
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field">
                    <label>CIN/NINU</label>
                    <input
                      name="number_piece"
                      placeholder="CIN/NINU"
                      type="number"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>
                </div>
                <div class="col-xl-12 pt-10 form-group">
                  <button class="nextBtn cmn--btn" data-translate="suivant">
                    Suivant
                  </button>
                </div>
              </div>
            </div>
            <div class="form second">
              <div class="details address">
                <span class="title" data-translate="docx">Document</span>
                <div class="fields">
                  <div class="input-field file-input-container">
                    <label for="file-input" data-translate="piece"
                      >Pièce d'identification du proprietaire</label
                    >
                    <div class="custom-file-label"></div>
                    <input
                      type="file"
                      name="piece_identite_proprietaire"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field file-input-container">
                    <label data-translate="labdel_preuve"
                      >Preuve d'adresse du proprietaire</label
                    >
                    <div class="custom-file-label"></div>
                    <input
                      type="file"
                      name="preuve_adresse_proprietaire"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field file-input-container">
                    <label data-translate="foto"
                      >Photo de la face l'Entreprise</label
                    >
                    <div class="custom-file-label"></div>
                    <input type="file" name="photo_face_entreprise" required />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field file-input-container">
                    <label data-translate="labelfoto"
                      >Photo du dos l'Entreprise</label
                    >
                    <div class="custom-file-label"></div>
                    <input type="file" name="photo_dos_entreprise" required />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field file-input-container">
                    <label data-translate="patente">Patente</label>
                    <div class="custom-file-label"></div>
                    <input type="file" name="patente" required />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field file-input-container">
                    <label data-translate="autre">Autre Document</label>
                    <div class="custom-file-label"></div>
                    <input type="file" name="autre_document" required />
                    <div class="error-message text-danger"></div>
                  </div>
                </div>
              </div>
              <div class="details family">
                <div class="fields">
                  <div class="input-field file-input-container">
                    <label data-translate="preuveemploye"
                      >Preuve d'adresse de l'employé</label
                    >
                    <div class="custom-file-label"></div>
                    <input type="file" name="preuve_adresse_employe" required />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field file-input-container">
                    <label data-translate="emploipiece"
                      >Pièce d'identification de l'employé</label
                    >
                    <div class="custom-file-label"></div>
                    <input type="file" name="piece_identite_employe" required />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field file-input-container">
                    <label data-translate="matikil"
                      >Matricule Fiscale de l'Entreprise</label
                    >
                    <div class="custom-file-label"></div>
                    <input
                      type="file"
                      name="matricule_fiscale_entreprise"
                      required
                    />
                    <div class="error-message text-danger"></div>
                  </div>
                  <div class="input-field file-input-container">
                    <label data-translate="photo"
                      >Photo de bord de l'entreprise</label
                    >
                    <div class="custom-file-label"></div>
                    <input type="file" name="photo_bord_entreprise" required />
                    <div class="error-message text-danger"></div>
                  </div>
                </div>
                <div class="buttons pt-10">
                  <div class="backBtn cmn--btn" data-translate="precedent">
                    Précédent
                  </div>
                  <button
                    class="sumbit cmn--btn"
                    type="submit"
                    disabled
                    data-translate="soumettre"
                  >
                    Soumettre
                  </button>
                </div>
              </div>
            </div>
          </form>
        </section>
      </div>
    </section>

    <!-- Footer -->
    <footer class="position-relative overflow-hidden">
      <div class="footer-top">
        <div class="container"></div>
      </div>
      <div class="footer-bottom bg--body py-4">
        <div class="container">
          <div
            class="d-flex flex-wrap justify-content-center justify-content-sm-between bottom-menu-wrapper"
          >
            <div class="footer-logo">
              <a href="#">
                <img src="./assets/images/logo.png" alt="logo" />
              </a>
            </div>
            <div class="copyright" data-translate="reserved">
              &copy; All Right Reserved by
              <a href="#" class="text--base">CshDirek S.A</a>
            </div>
            <ul class="bottom-menu">
              <li>
                <a href="./privacy.html" data-translate="privacy">Privacy</a>
              </li>
              <li>
                <a href="./privacy.html" data-translate="term"
                  >Terms and Condition</a
                >
                <a href="./privacy.html" data-translate="term"
                  >Terms and Condition</a
                >
              </li>
              <li>
                <a href="./legal_moniteur.pdf" data-translate="moniteur"
                  >Legal Moniteur</a
                >
              </li>
            </ul>
          </div>
        </div>
      </div>

      <span class="banner-elem elem3">&nbsp;</span>
      <span class="banner-elem elem5">&nbsp;</span>
      <span class="banner-elem elem6">&nbsp;</span>
      <span class="banner-elem elem8">&nbsp;</span>
    </footer>
    <!-- Footer -->

    <script src="./assets/frontend/js/jquery-3.6.0.min.js"></script>
    <script src="./assets/frontend/js/bootstrap.min.js"></script>
    <script src="./assets/frontend/js/viewport.jquery.js"></script>
    <script src="./assets/frontend/js/odometer.min.js"></script>
    <script src="./assets/frontend/js//owl.min.js"></script>
    <script src="./assets/frontend/js/tilt.js"></script>
    <script src="./assets/frontend/js/main.js"></script>
    <script src="./assets/admin/js/sweetalert2@9.js"></script>
    <script>
      const translations = {
        en: "./assets/lang/en.json",
        fr: "./assets/lang/fr.json",
        ht: "./assets/lang/ht.json",
      };

      async function loadTranslations(lang) {
        try {
          const response = await fetch(translations[lang]);
          if (!response.ok) throw new Error(`Erreur de chargement de langue: ${lang}`);
          const data = await response.json();
  
          // 1. Traduire les éléments statiques
          document.querySelectorAll("[data-translate]").forEach((element) => {
            const key = element.getAttribute("data-translate");
            if (data[key]) {
              if (element.textContent) element.textContent = data[key];
              if (element.tagName === "INPUT" && element.hasAttribute("placeholder")) {
                element.setAttribute("placeholder", data[key]);
              }
            }
          });
  
          // 2. Traduire spécifiquement les placeholders des select
          const selectsToTranslate = {
            "categorie": "select_category",
            "genre": "select_gender", 
            "type_entreprise": "select_entreprise_type",
            "city": "select_city",
            "departement": "select_departement"
          };
  
          for (const [id, translationKey] of Object.entries(selectsToTranslate)) {
            const select = document.getElementById(id);
            if (select && select.firstElementChild && data[translationKey]) {
              select.firstElementChild.textContent = data[translationKey];
            }
          }
  
        } catch (error) {
          console.error(error.message);
        }
        if (lang !== currentLang) {
          fillSelect("cities", "city", "select_city");
          fillSelect("departements", "departement", "select_departement");
          fillSelect("genders", "genre", "select_gender");
          fillSelect("categories", "categorie", "select_category");
          fillSelect(
            "type-entreprises",
            "type_entreprise",
            "select_entreprise_type"
          );
        }
      }

      // Fonction pour sauvegarder la langue sélectionnée dans localStorage
      function saveLanguageToLocalStorage(lang) {
        localStorage.setItem("selectedLanguage", lang);
      }

      // Fonction pour charger la langue depuis localStorage
      function loadLanguageFromLocalStorage() {
        const savedLang = localStorage.getItem("selectedLanguage");
        return savedLang || "en"; // Si aucune langue n'est sauvegardée, on charge 'en' par défaut
      }

      // Gestion du changement de langue pour les deux sélecteurs
      document
        .getElementById("languageSelectorDesktop")
        .addEventListener("change", (event) => {
          const selectedLang = event.target.value;
          loadTranslations(selectedLang);
          saveLanguageToLocalStorage(selectedLang); // Sauvegarde de la langue sélectionnée
        });

      document
        .getElementById("languageSelectorMobile")
        .addEventListener("change", (event) => {
          const selectedLang = event.target.value;
          loadTranslations(selectedLang);
          saveLanguageToLocalStorage(selectedLang); // Sauvegarde de la langue sélectionnée
        });

      // Charger la langue par défaut (ou la langue sauvegardée dans localStorage)
      const defaultLang = loadLanguageFromLocalStorage();
      loadTranslations(defaultLang);
      document.getElementById("languageSelectorDesktop").value = defaultLang;
      document.getElementById("languageSelectorMobile").value = defaultLang;
    </script>

    <script>
      const form = document.querySelector("form"),
        nextBtn = form.querySelector(".nextBtn"),
        backBtn = form.querySelector(".backBtn"),
        allInput = form.querySelectorAll(".first input:not([type='file'])");

      nextBtn.addEventListener("click", () => {
        let allFilled = true;
        allInput.forEach((input) => {
          if (input.value.trim() === "") {
            allFilled = false;
          }
        });

        if (allFilled) {
          form.classList.add("secActive");
        } else {
          form.classList.remove("secActive");
        }
      });

      backBtn.addEventListener("click", () =>
        form.classList.remove("secActive")
      );

      function handleFileInput(event) {
        const container = event.target.closest(".file-input-container");
        const label = container.querySelector(".custom-file-label");
        if (event.target.files.length > 0) {
          label.textContent = "✔";
          label.style.color = "green";
          label.style.fontSize = "1.2em";
        } else {
          label.style.color = "";
          label.style.fontSize = "";
        }
        checkFields();
      }

      const fileInputs = document.querySelectorAll('input[type="file"]');
      fileInputs.forEach((input) => {
        input.addEventListener("change", handleFileInput);
      });

      function checkFields() {
        const allTextInputs = form.querySelectorAll(
          'input[type="text"], input[type="number"], input[type="email"], select'
        );
        const allFileInputs = form.querySelectorAll('input[type="file"]');

        let allTextFilled = true;
        allTextInputs.forEach((input) => {
          if (input.value.trim() === "") {
            allTextFilled = false;
          }
        });

        let allFilesFilled = true;
        allFileInputs.forEach((input) => {
          if (input.files.length === 0) {
            allFilesFilled = false;
          }
        });

        const submitButton = form.querySelector(".sumbit");
        submitButton.disabled = !(allTextFilled && allFilesFilled);
      }

      const textInputs = form.querySelectorAll(
        'input[type="text"], input[type="number"], input[type="email"], select'
      );
      textInputs.forEach((input) => {
        input.addEventListener("input", checkFields);
      });
      fileInputs.forEach((input) => {
        input.addEventListener("change", checkFields);
      });
    </script>
    <script>
      const API_URL = "https://api.cshdirek.com/api/v1/landing";

      // Fill select
      async function fillSelect(
        endpoint,
        selectId,
        translationKey = null,
        filter = null,
        defaultValue = null
      ) {
        const select = document.getElementById(selectId);
        const lang = document.getElementById("languageSelectorDesktop").value;

        let defaultText = "Choisir...";

        if (translationKey) {
          try {
            const response = await fetch(translations[lang]);
            const data = await response.json();
            defaultText = data[translationKey] || translationKey;
          } catch (e) {
            console.error("Erreur de chargement de traduction:", e);
          }
        }

        // Sauvegarde la valeur sélectionnée actuelle
        const currentValue = select.value;

        select.innerHTML = `<option value="" disabled selected>${defaultText}</option>`;

        let url = `${API_URL}/${endpoint}/`;
        if (filter) {
          const query = new URLSearchParams(filter).toString();
          url += `?${query}`;
        }

        try {
          const res = await fetch(url);
          const data = await res.json();

          if (Array.isArray(data.results)) {
            data.results.forEach((item) => {
              const opt = document.createElement("option");
              opt.value = item.id;
              opt.textContent = item.name;
              if (item.id === defaultValue) opt.selected = true;
              select.appendChild(opt);
            });

            // Restaure la sélection précédente si elle existe
            if (
              currentValue &&
              select.querySelector(`option[value="${currentValue}"]`)
            ) {
              select.value = currentValue;
            }
          }
        } catch (error) {
          console.error("Erreur lors du chargement des données:", error);
        }
      }

      // Initial load
      // Pour le pays (sans traduction du texte par défaut)
      fillSelect("countries", "country", null, null, "HT");

      // Pour les autres select (avec traduction)
      fillSelect("cities", "city", "select_city");
      fillSelect("departements", "departement", "select_departement");
      fillSelect("genders", "genre", "select_gender");
      fillSelect("categories", "categorie", "select_category");
      fillSelect(
        "type-entreprises",
        "type_entreprise",
        "select_entreprise_type"
      );

      // city auto load on departement change
      document
        .getElementById("departement")
        .addEventListener("change", function () {
          fillSelect("cities", "city", "Choisir une ville", {
            departement: this.value,
          });
        });
    </script>
    <script>
      document
        .querySelector("form")
        .addEventListener("submit", async function (e) {
          e.preventDefault();

          document
            .querySelectorAll(".error-message")
            .forEach((el) => (el.textContent = ""));
          const formData = new FormData();

          // Champs texte
          const fields = [
            "user_type",
            "first_name",
            "last_name",
            "entreprise_nom",
            "country",
            "departement",
            "longitude",
            "latitude",
            "city",
            "entreprise_adresse",
            "proprietaire_adresse",
            "type_entreprise",
            "categorie",
            "proprietaire_email",
            "proprietaire_telephone",
            "genre",
            "number_piece",
          ];

          fields.forEach((field) => {
            const input = document.querySelector(`[name="${field}"]`);
            if (input) formData.append(field, input.value);
          });

          // Champs fichiers
          const fileFields = [
            "piece_identite_proprietaire",
            "preuve_adresse_proprietaire",
            "photo_face_entreprise",
            "photo_dos_entreprise",
            "patente",
            "autre_document",
            "preuve_adresse_employe",
            "piece_identite_employe",
            "matricule_fiscale_entreprise",
            "photo_bord_entreprise",
          ];

          fileFields.forEach((fieldName) => {
            const input = document.querySelector(`[name="${fieldName}"]`);
            if (input && input.files.length > 0) {
              formData.append(fieldName, input.files[0]);
            }
          });

          const submitBtn = document.querySelector(".sumbit");
          submitBtn.disabled = true;
          submitBtn.textContent = "Chargement...";

          try {
            const res = await fetch(
              "https://api.cshdirek.com/api/v1/landing/register/",
              {
                method: "POST",
                body: formData,
              }
            );

            const data = await res.json();

            if (res.ok) {
              form.style.display = "none";

              const successDiv = document.createElement("div");
              successDiv.className = "text-center mt-5";

              successDiv.innerHTML = `
                <h4 class="text-success mb-4" data-translate="success_title">✅ Demande soumise avec succès !</h4>
                <p class="mb-4" data-translate="login">
                  Nous avons bien reçu votre demande. Notre équipe analysera votre dossier
                  et vous recevrez une réponse sous peu.
                </p>
                <a href="https://api.cshdirek.com/admin/cshdirek/login/" class="cmn--btn" data-translate="login">Login</a>
              `;

              form.parentNode.appendChild(successDiv);
            } else {
              const errors = data.errors || data;

              let hasSecondPartError = false;
              const secondPartFields = [
                "piece_identite_proprietaire",
                "preuve_adresse_proprietaire",
                "photo_face_entreprise",
                "photo_dos_entreprise",
                "patente",
                "autre_document",
                "preuve_adresse_employe",
                "piece_identite_employe",
                "matricule_fiscale_entreprise",
                "photo_bord_entreprise",
              ];

              for (const field in errors) {
                if (secondPartFields.includes(field)) {
                  hasSecondPartError = true;
                  break;
                }
              }

              // Activer la bonne section
              if (hasSecondPartError) {
                form.classList.add("secActive");
              } else {
                form.classList.remove("secActive");
              }

              // Afficher erreurs
              for (const field in errors) {
                const input = document.querySelector(`[name="${field}"]`);
                if (input) {
                  const errorDiv = input
                    .closest(".input-field")
                    .querySelector(".error-message");
                  if (errorDiv) {
                    errorDiv.textContent = errors[field][0] || "Erreur";
                  }
                }
              }
            }
          } catch (error) {
            console.error("Erreur réseau :", error);
            alert("Erreur réseau !");
          }
          submitBtn.disabled = false;
          submitBtn.textContent = "Soumettre";
        });
    </script>
  </body>
</html>
